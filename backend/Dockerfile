FROM node:20-alpine

# Herramientas b√°sicas por si alg√∫n paquete las necesita
RUN apk add --no-cache python3 make g++ libc6-compat

WORKDIR /app

# Copiamos SOLO los manifests para aprovechar la cache
COPY package*.json ./

# üëá Asegura instalar tambi√©n devDependencies (ts-node, @types/*, nodemon)
#    --include=dev funciona en npm 9/10 y evita que NODE_ENV=production las omita
RUN npm ci --include=dev

# Ahora s√≠, el resto del c√≥digo
COPY tsconfig.json ./
COPY src ./src

EXPOSE 3000
CMD ["npm","run","start"]